# ============================================================================
# Dependabot Configuration for FinS Project (Optimized)
# ============================================================================
# Tối ưu hóa để giảm số lượng PRs và tránh CI/CD overload
# - Group các dependencies lại để giảm số PR
# - Chỉ update security patches (bỏ qua minor updates)
# - Giảm open-pull-requests-limit
# ============================================================================

version: 2

updates:
  # ============================================================================
  # Java/Maven Dependencies - CHỈ SECURITY/PATCH UPDATES
  # ============================================================================
  - package-ecosystem: "maven"
    directory: "/microservices/gateway"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "Asia/Ho_Chi_Minh"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "java"
    commit-message:
      prefix: "deps(gateway):"
    # Bỏ qua minor updates, chỉ lấy patch/security
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      spring-and-jhipster:
        patterns:
          - "org.springframework*"
          - "tech.jhipster*"
        
  - package-ecosystem: "maven"
    directory: "/microservices/userservice"
    schedule:
      interval: "weekly"
      day: "monday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "java"
    commit-message:
      prefix: "deps(userservice):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-deps:
        patterns:
          - "*"

  - package-ecosystem: "maven"
    directory: "/microservices/stockservice"
    schedule:
      interval: "weekly"
      day: "monday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "java"
    commit-message:
      prefix: "deps(stockservice):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-deps:
        patterns:
          - "*"

  - package-ecosystem: "maven"
    directory: "/microservices/newsservice"
    schedule:
      interval: "weekly"
      day: "monday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "java"
    commit-message:
      prefix: "deps(newsservice):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-deps:
        patterns:
          - "*"

  - package-ecosystem: "maven"
    directory: "/microservices/notificationservice"
    schedule:
      interval: "weekly"
      day: "monday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "java"
    commit-message:
      prefix: "deps(notificationservice):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-deps:
        patterns:
          - "*"

  - package-ecosystem: "maven"
    directory: "/microservices/crawlservice"
    schedule:
      interval: "weekly"
      day: "monday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "java"
    commit-message:
      prefix: "deps(crawlservice):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-deps:
        patterns:
          - "*"

  - package-ecosystem: "maven"
    directory: "/microservices/aitoolsservice"
    schedule:
      interval: "weekly"
      day: "monday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "java"
    commit-message:
      prefix: "deps(aitoolsservice):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-deps:
        patterns:
          - "*"

  # ============================================================================
  # NPM Dependencies (Frontend) - Group tất cả lại
  # ============================================================================
  - package-ecosystem: "npm"
    directory: "/client/smarttrade-web"
    schedule:
      interval: "weekly"
      day: "tuesday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "javascript"
      - "frontend"
    commit-message:
      prefix: "deps(frontend):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-frontend:
        patterns:
          - "*"

  # ============================================================================
  # Python Dependencies (AI Service)
  # ============================================================================
  - package-ecosystem: "pip"
    directory: "/microservices/aiservice"
    schedule:
      interval: "weekly"
      day: "wednesday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "python"
    commit-message:
      prefix: "deps(aiservice):"
    ignore:
      - dependency-name: "*"
        update-types: ["version-update:semver-minor"]
    groups:
      all-python:
        patterns:
          - "*"

  # ============================================================================
  # Docker Dependencies - Monthly only
  # ============================================================================
  - package-ecosystem: "docker"
    directory: "/microservices/aiservice"
    schedule:
      interval: "monthly"
    open-pull-requests-limit: 1
    labels:
      - "dependencies"
      - "docker"
    commit-message:
      prefix: "deps(docker):"

  - package-ecosystem: "docker"
    directory: "/client/smarttrade-web"
    schedule:
      interval: "monthly"
    open-pull-requests-limit: 1
    labels:
      - "dependencies"
      - "docker"
    commit-message:
      prefix: "deps(docker):"

  # ============================================================================
  # GitHub Actions - Group all
  # ============================================================================
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "sunday"
    open-pull-requests-limit: 2
    labels:
      - "dependencies"
      - "ci/cd"
    commit-message:
      prefix: "deps(actions):"
    groups:
      all-actions:
        patterns:
          - "*"
